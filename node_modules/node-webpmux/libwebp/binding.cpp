#include <stdlib.h>
#include <stdio.h>
#include <emscripten.h>
#include <emscripten/bind.h>
#include "libwebp/src/webp/encode.h"
#include "libwebp/src/webp/decode.h"

using namespace emscripten;

class WebPEnc {
  public:
    WebPEnc() { this->ready = false; this->picAlloc = false; }
    ~WebPEnc() { this->reset(); }
    bool init() {
      if (this->ready) { return false; }
      WebPPictureInit(&(this->pic));
      WebPMemoryWriterInit(&(this->writer));
      this->pic.writer = WebPMemoryWrite;
      this